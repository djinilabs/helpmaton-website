---
interface FAQItem {
  question: string;
  answer: string;
  category: string;
}

const faqs: FAQItem[] = [
  // Getting Started
  {
    category: "Getting Started",
    question: "How do I create my first workspace?",
    answer: `<strong>Workspace creation</strong><br/>
After signing up, you'll be prompted to create your first workspace. A workspace is like a container for your AI agents, documents, and team members.<br/><br/>
<strong>Multiple workspaces</strong> allow you to organize different projects or client accounts, each with its own budget, permissions, and team members.`
  },
  {
    category: "Getting Started",
    question: "What do I need to get started?",
    answer: `<strong>Account setup</strong><br/>
You need a Helpmaton account and either your own OpenRouter API key (BYOK - Bring Your Own Key) or you can purchase credits through Helpmaton.<br/><br/>
<strong>OpenRouter keys</strong> are the only supported keys for BYOK. Once you have a workspace, you can start creating agents and uploading documents.<br/><br/>
For detailed setup instructions, see the <a href="https://github.com/djinilabs/helpmaton/blob/main/docs/getting-started.md" target="_blank" rel="noopener noreferrer" class="text-primary-600 hover:text-primary-700 underline">Getting Started Guide</a>.`
  },
  {
    category: "Getting Started",
    question: "How do I create my first agent?",
    answer: `<strong>Agent creation</strong><br/>
Navigate to your workspace, click 'Create Agent', give it a name and personality/instructions. You can configure tools, memory settings, and other options.<br/><br/>
<strong>Immediate availability</strong> - Your agent will be ready to use immediately after creation with its own webhook endpoint for easy integration.`
  },
  
  // Agents
  {
    category: "Agents",
    question: "How does agent memory work?",
    answer: `<strong>Stratified memory architecture</strong><br/>
Agents use a sophisticated memory system with temporal grains (daily, weekly, monthly, quarterly, yearly). They progressively summarize conversations and use semantic vector search to retrieve relevant memories.<br/><br/>
<strong>Memory retention</strong> - Free plans retain 48 hours of working memory plus 30 days of summaries, while Pro plans extend to 240 hours plus 120 days. Memories are stored in LanceDB with S3 backend for scalable, distributed storage.<br/><br/>
<strong>Vector search</strong> enables context-aware responses informed by past interactions through semantic similarity matching.<br/><br/>
Learn more in the <a href="https://github.com/djinilabs/helpmaton/blob/main/docs/agent-memory-system.md" target="_blank" rel="noopener noreferrer" class="text-primary-600 hover:text-primary-700 underline">Agent Memory System documentation</a> and <a href="https://github.com/djinilabs/helpmaton/blob/main/docs/vector-database.md" target="_blank" rel="noopener noreferrer" class="text-primary-600 hover:text-primary-700 underline">Vector Database guide</a>.`
  },
  {
    category: "Agents",
    question: "Can agents work together?",
    answer: `<strong>Agent delegation</strong><br/>
Yes! Agents can delegate tasks to other agents in the same workspace. This enables complex multi-agent workflows where specialized agents handle different aspects of a task.<br/><br/>
<strong>Multi-agent collaboration</strong> - You can set up teams of agents that collaborate on complex projects, with support for async delegation, query-based matching, and delegation tracking.`
  },
  {
    category: "Agents",
    question: "What tools do agents have access to?",
    answer: `<strong>Built-in tools</strong><br/>
Agents have comprehensive built-in tools: document search (semantic vector search), memory search (recall past conversations), web search (find current information), web fetch (extract content from URLs), email sending, notification sending (Discord/Slack), and agent delegation.<br/><br/>
<strong>MCP servers</strong> - You can extend agents with Model Context Protocol (MCP) servers to connect to external APIs, databases, and custom tools. Configure MCP servers with custom authentication and enable them per-agent.`
  },
  {
    category: "Agents",
    question: "How do I configure an agent's personality?",
    answer: `<strong>Custom instructions</strong><br/>
When creating or editing an agent, you can set custom instructions that define its personality, behavior, and how it should respond.<br/><br/>
<strong>System prompts</strong> guide the agent's decision-making and communication style, enabling you to create agents tailored to specific use cases and brand voices.`
  },
  
  // Workspaces
  {
    category: "Workspaces",
    question: "What are workspace credits used for?",
    answer: `<strong>AI provider costs</strong><br/>
Workspace credits are used for AI provider calls (OpenRouter, OpenAI, Anthropic, Google, etc.), not for platform subscription costs.<br/><br/>
<strong>Flexible billing</strong> - You can either provide your own OpenRouter API key (BYOK) and pay providers directly, or purchase credits through Helpmaton for usage-based billing with transparent pricing.`
  },
  {
    category: "Workspaces",
    question: "Can I use my own API keys?",
    answer: `<strong>BYOK with OpenRouter</strong><br/>
Yes! Helpmaton supports BYOK (Bring Your Own Key), but only OpenRouter API keys are currently supported.<br/><br/>
<strong>Direct billing</strong> - When you add an OpenRouter API key to your workspace, requests use your key and you pay OpenRouter directly. Credit reservation and adjustment are skipped, but spending limits and token usage tracking still apply for analytics and limit enforcement.`
  },
  {
    category: "Workspaces",
    question: "How do spending limits work?",
    answer: `<strong>Granular control</strong><br/>
You can set spending limits at both workspace and individual agent levels. Limits can be set for daily, monthly, or yearly periods using rolling windows.<br/><br/>
<strong>Atomic operations</strong> - The system uses atomic credit reservation with DynamoDB to prevent overspending and race conditions. Limits are checked before credit reservation, and spending is calculated from token usage aggregates.`
  },
  {
    category: "Workspaces",
    question: "How many team members can I add?",
    answer: `<strong>Team collaboration</strong><br/>
Free plans support limited team members, while Pro plans support unlimited managers.<br/><br/>
<strong>Permission levels</strong> - Team members can have different permission levels: READ (view only), WRITE (can make changes), and OWNER (full control). Pro plan subscriptions support multiple managers with shared access to all workspaces.`
  },
  
  // Billing & Pricing
  {
    category: "Billing & Pricing",
    question: "What's included in my subscription?",
    answer: `<strong>Platform services</strong><br/>
Your monthly subscription covers all Helpmaton platform services: hosting, infrastructure, agent configuration and management, memory system, analytics, workspaces, team collaboration, document storage, and all Helpmaton-related API calls.<br/><br/>
<strong>Infrastructure</strong> includes AWS serverless infrastructure (Lambda, DynamoDB, S3, API Gateway, CloudFront), vector database (LanceDB with S3), and all platform features.`
  },
  {
    category: "Billing & Pricing",
    question: "Are AI provider calls included in my subscription?",
    answer: `<strong>Separate costs</strong><br/>
No, AI provider calls (OpenRouter, OpenAI, Anthropic, Google, etc.) are separate from your subscription.<br/><br/>
<strong>Two options</strong> - You can either use your own OpenRouter API key (BYOK) and pay providers directly, or purchase credits through Helpmaton for usage-based billing. Credits are automatically reserved before LLM calls and adjusted after based on actual token usage.`
  },
  {
    category: "Billing & Pricing",
    question: "How much do web search calls cost?",
    answer: `<strong>Free daily allowance</strong><br/>
All plans include 10 free web search calls per 24 hours. Additional calls are billed at $0.008 per call.<br/><br/>
<strong>Transparent pricing</strong> - This gives you access to real-time information at a cost-effective rate, perfect for research assistants, news monitoring, and content analysis workflows.`
  },
  {
    category: "Billing & Pricing",
    question: "How does credit reservation work?",
    answer: `<strong>Atomic credit management</strong><br/>
Before making an LLM API call, the system estimates the cost and atomically reserves credits by deducting the estimated amount from your workspace balance.<br/><br/>
<strong>Post-call adjustment</strong> - After the call completes, the system calculates actual cost from token usage and adjusts the reservation (refunds if actual < reserved, charges additional if actual > reserved). This ensures accurate billing and prevents overspending.<br/><br/>
Learn more in the <a href="https://github.com/djinilabs/helpmaton/blob/main/docs/credit-system.md" target="_blank" rel="noopener noreferrer" class="text-primary-600 hover:text-primary-700 underline">Credit System documentation</a> and <a href="https://github.com/djinilabs/helpmaton/blob/main/docs/pricing-calculation.md" target="_blank" rel="noopener noreferrer" class="text-primary-600 hover:text-primary-700 underline">Pricing Calculation guide</a>.`
  },
  
  // API & Integrations
  {
    category: "API & Integrations",
    question: "How do I access the API?",
    answer: `<strong>REST API</strong><br/>
Helpmaton provides a comprehensive REST API with OpenAPI documentation. You can authenticate using session-based authentication, JWT tokens (24-hour expiration), workspace API keys, or OAuth.<br/><br/>
<strong>OpenAPI docs</strong> - Complete API documentation is available in OpenAPI format. Generate client libraries, explore endpoints, and understand request/response schemas at the <a href="https://app.helpmaton.com/docs/api" target="_blank" rel="noopener noreferrer" class="text-primary-600 hover:text-primary-700 underline">API Reference</a>.<br/><br/>
See also the <a href="https://github.com/djinilabs/helpmaton/blob/main/docs/api-reference.md" target="_blank" rel="noopener noreferrer" class="text-primary-600 hover:text-primary-700 underline">API Reference documentation</a> in the repository.`
  },
  {
    category: "API & Integrations",
    question: "Can I set up webhooks?",
    answer: `<strong>Webhook endpoints</strong><br/>
Yes! Every agent exposes a webhook endpoint that accepts HTTP POST requests. Send messages and receive AI-powered responses, making integration with your applications straightforward.<br/><br/>
<strong>Streaming support</strong> - Supports both synchronous responses and real-time streaming via Server-Sent Events (SSE) or Lambda Function URLs for token-by-token streaming responses.`
  },
  {
    category: "API & Integrations",
    question: "What are MCP servers?",
    answer: `<strong>Model Context Protocol</strong><br/>
MCP (Model Context Protocol) servers allow you to extend your agents' capabilities by connecting them to external APIs, databases, and custom tools.<br/><br/>
<strong>Configuration</strong> - Configure MCP servers with custom authentication (none, header, or basic auth) and enable them per-agent. Tools are created dynamically from MCP servers using JSON-RPC 2.0 protocol.<br/><br/>
See the <a href="https://github.com/djinilabs/helpmaton/blob/main/docs/mcp-servers.md" target="_blank" rel="noopener noreferrer" class="text-primary-600 hover:text-primary-700 underline">MCP Servers documentation</a> for detailed setup instructions.`
  },
  {
    category: "API & Integrations",
    question: "How do I deploy agents as Slack or Discord bots?",
    answer: `<strong>Chat platform integration</strong><br/>
Go to the Integrations page in your workspace. For Slack, you can generate a dynamic app manifest for easy setup. For Discord, you'll configure slash commands.<br/><br/>
<strong>Secure by default</strong> - Both support secure signature verification (Slack webhook signatures, Discord Ed25519 signatures) and provide streaming-like experience with throttled message updates. Bots have access to all agent tools, memory, and knowledge bases.<br/><br/>
See the <a href="https://github.com/djinilabs/helpmaton/blob/main/docs/slack-integration.md" target="_blank" rel="noopener noreferrer" class="text-primary-600 hover:text-primary-700 underline">Slack Integration guide</a> and <a href="https://github.com/djinilabs/helpmaton/blob/main/docs/discord-integration.md" target="_blank" rel="noopener noreferrer" class="text-primary-600 hover:text-primary-700 underline">Discord Integration guide</a> for detailed setup instructions.`
  },
  
  // Technical
  {
    category: "Technical",
    question: "How are errors handled?",
    answer: `<strong>Automatic error tracking</strong><br/>
Conversations automatically persist and display errors when LLM calls fail. You'll see detailed error messages with stack traces, provider information, and metadata.<br/><br/>
<strong>Error visibility</strong> - Error badges appear in conversation lists for quick identification, and detailed error views help you quickly identify and debug issues. All errors are tracked historically across conversations.`
  },
  {
    category: "Technical",
    question: "What file formats are supported for documents?",
    answer: `<strong>Document management</strong><br/>
Helpmaton supports markdown and text documents. You can upload documents and organize them in folders.<br/><br/>
<strong>Semantic search</strong> - Your agents can then search through these documents using semantic vector search to provide informed responses. Documents are stored in S3 with metadata in DynamoDB.`
  },
  {
    category: "Technical",
    question: "How does web search work?",
    answer: `<strong>Real-time information access</strong><br/>
Agents can search the web for current information, news, and articles using the search_web tool. They can also extract and summarize content from any web page URL using the fetch_web tool.<br/><br/>
<strong>Easy enablement</strong> - Both features can be enabled per-agent with simple toggle switches. Perfect for research assistants, news monitoring, and content analysis workflows.`
  },
  {
    category: "Technical",
    question: "What infrastructure does Helpmaton use?",
    answer: `<strong>AWS serverless architecture</strong><br/>
Helpmaton is built on AWS serverless infrastructure: Lambda functions (Node.js 20.x), DynamoDB (NoSQL database with encryption at rest), S3 (document storage and vector database backend), API Gateway (REST API), CloudFront (CDN and SPA routing), and Route53 (DNS).<br/><br/>
<strong>Vector database</strong> - LanceDB with S3 backend for agent memory and semantic search. SQS FIFO queues ensure serialized writes per database via message groups.<br/><br/>
<strong>Region</strong> - Deployed in eu-west-2 (London) with automatic horizontal scaling and high availability.<br/><br/>
See the <a href="https://github.com/djinilabs/helpmaton/blob/main/docs/architecture.md" target="_blank" rel="noopener noreferrer" class="text-primary-600 hover:text-primary-700 underline">Architecture Overview</a> and <a href="https://github.com/djinilabs/helpmaton/blob/main/docs/database-schema.md" target="_blank" rel="noopener noreferrer" class="text-primary-600 hover:text-primary-700 underline">Database Schema</a> documentation for detailed technical information.`
  },
  {
    category: "Technical",
    question: "How does usage analytics work?",
    answer: `<strong>Comprehensive tracking</strong><br/>
Helpmaton tracks comprehensive token usage including prompt, completion, reasoning, and cached tokens. Data is aggregated daily and hourly, with historical data available through date range filtering.<br/><br/>
<strong>Multi-dimensional breakdowns</strong> - You can view breakdowns per-workspace or per-agent. Costs are calculated with support for tiered pricing models, separate reasoning token billing, and cached prompt token tracking.`
  },
  
  // Self-Hosting & Open Source
  {
    category: "Self-Hosting & Open Source",
    question: "Is Helpmaton open source?",
    answer: `<strong>Source-available license</strong><br/>
Yes! Helpmaton is licensed under the Business Source License 1.1, making the source code available for evaluation, internal use, and contribution.<br/><br/>
<strong>License terms</strong> - The license protects the ability to offer it as a commercial hosted service until November 1st, 2029, when it will automatically convert to Apache License 2.0. You can view, modify, and contribute to the code on <a href="https://github.com/djinilabs/helpmaton" target="_blank" rel="noopener noreferrer" class="text-primary-600 hover:text-primary-700 underline">GitHub</a>.<br/><br/>
See the <a href="https://github.com/djinilabs/helpmaton/blob/main/LICENSE.md" target="_blank" rel="noopener noreferrer" class="text-primary-600 hover:text-primary-700 underline">LICENSE file</a> for full license terms.`
  },
  {
    category: "Self-Hosting & Open Source",
    question: "What license does Helpmaton use?",
    answer: `<strong>Business Source License 1.1</strong><br/>
Helpmaton uses the Business Source License 1.1, which makes the software source-available while protecting commercial hosting rights until the Change Date.<br/><br/>
<strong>Change Date</strong> - On November 1st, 2029, the license automatically converts to Apache License 2.0, making it fully open source. Until then, you cannot provide Helpmaton as a hosted SaaS offering to third parties, but internal use and self-hosting for your own business is permitted.<br/><br/>
Read the full license terms in the <a href="https://github.com/djinilabs/helpmaton/blob/main/LICENSE.md" target="_blank" rel="noopener noreferrer" class="text-primary-600 hover:text-primary-700 underline">LICENSE.md file</a>.`
  },
  {
    category: "Self-Hosting & Open Source",
    question: "Can I self-host Helpmaton?",
    answer: `<strong>Full self-hosting support</strong><br/>
Yes! The complete source code is available on <a href="https://github.com/djinilabs/helpmaton" target="_blank" rel="noopener noreferrer" class="text-primary-600 hover:text-primary-700 underline">GitHub</a>, so you can spin up your own instance, customize it to your needs, and run it on your own infrastructure.<br/><br/>
<strong>Infrastructure requirements</strong> - You'll need AWS account with Lambda, DynamoDB, S3, API Gateway, CloudFront, and Route53. The platform uses Architect Framework for deployment. See the <a href="https://github.com/djinilabs/helpmaton/blob/main/docs/deployment.md" target="_blank" rel="noopener noreferrer" class="text-primary-600 hover:text-primary-700 underline">deployment documentation</a> for detailed setup instructions.<br/><br/>
<strong>Full control</strong> - Self-hosting gives you complete control over your data, infrastructure, and customization, with zero vendor lock-in.`
  },
  {
    category: "Self-Hosting & Open Source",
    question: "What do I need to self-host Helpmaton?",
    answer: `<strong>Infrastructure setup</strong><br/>
You'll need an AWS account with access to Lambda, DynamoDB, S3, API Gateway, CloudFront, Route53, and ACM (for SSL certificates). The platform is designed for AWS serverless infrastructure.<br/><br/>
<strong>Development setup</strong> - Local development uses Architect Sandbox (DynamoDB emulator) and s3rver (local S3). See the <a href="https://github.com/djinilabs/helpmaton/blob/main/docs/development-setup.md" target="_blank" rel="noopener noreferrer" class="text-primary-600 hover:text-primary-700 underline">development setup guide</a> for detailed instructions.<br/><br/>
<strong>Deployment</strong> - Automated deployment via GitHub Actions or manual deployment using Architect Framework. All required environment variables and secrets are documented in the <a href="https://github.com/djinilabs/helpmaton/blob/main/docs/deployment.md" target="_blank" rel="noopener noreferrer" class="text-primary-600 hover:text-primary-700 underline">deployment guide</a>.`
  },
  {
    category: "Self-Hosting & Open Source",
    question: "How does the vector database work?",
    answer: `<strong>LanceDB with S3 backend</strong><br/>
Agent memory uses LanceDB with S3 as the storage backend. Each agent has multiple temporal databases (daily, weekly, monthly, quarterly, yearly) for storing compressed facts.<br/><br/>
<strong>Write serialization</strong> - SQS FIFO queues ensure write serialization through message groups (one write operation per database at a time), preventing race conditions.<br/><br/>
<strong>Read access</strong> - Direct query access is available from Lambda functions using the lancedb container image. Vector similarity search enables efficient context retrieval across agent knowledge.<br/><br/>
See the <a href="https://github.com/djinilabs/helpmaton/blob/main/docs/vector-database.md" target="_blank" rel="noopener noreferrer" class="text-primary-600 hover:text-primary-700 underline">Vector Database documentation</a> for complete technical details.`
  }
];

const categories = Array.from(new Set(faqs.map(faq => faq.category)));
---

<div class="space-y-6">
  <!-- Search Input -->
  <div class="bg-white rounded-lg shadow-soft p-6 border border-neutral-200">
    <label for="faq-search" class="block text-sm font-semibold text-neutral-900 mb-3">
      Search FAQs
    </label>
    <input
      type="text"
      id="faq-search"
      placeholder="Type to search questions and answers..."
      class="w-full px-4 py-3 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-neutral-900 placeholder:text-neutral-400"
    />
  </div>

  <!-- No Results Message (hidden by default) -->
  <div id="no-results" class="hidden bg-white rounded-lg shadow-soft p-6 border border-neutral-200 text-center">
    <p class="text-neutral-600">No FAQs found matching your search.</p>
  </div>

  <!-- FAQ Items by Category -->
  {categories.map((category) => (
    <div class="faq-category" data-category={category}>
      <h2 class="text-2xl font-semibold text-neutral-900 mb-4">{category}</h2>
      <div class="space-y-4">
        {faqs.filter(faq => faq.category === category).map((faq, index) => (
          <div
            class="faq-item bg-white rounded-lg shadow-soft p-6 border border-neutral-200"
            data-question={faq.question.toLowerCase()}
            data-answer={faq.answer.toLowerCase()}
          >
            <h3 class="text-lg font-semibold text-neutral-900 mb-3">
              {faq.question}
            </h3>
            <div
              class="text-neutral-600 leading-relaxed [&_strong]:text-primary-700 [&_strong]:font-semibold [&_strong]:text-base [&_br]:block [&_br]:mb-2 [&_a]:text-primary-600 [&_a]:hover:text-primary-700 [&_a]:underline [&_a]:transition-colors"
              set:html={faq.answer}
            />
          </div>
        ))}
      </div>
    </div>
  ))}
</div>

<script>
  const searchInput = document.getElementById('faq-search');
  const faqItems = document.querySelectorAll('.faq-item');
  const faqCategories = document.querySelectorAll('.faq-category');
  const noResults = document.getElementById('no-results');

  function filterFAQs(searchTerm) {
    const term = searchTerm.toLowerCase().trim();
    let hasResults = false;

    // Filter FAQ items
    faqItems.forEach((item) => {
      const question = item.getAttribute('data-question') || '';
      const answer = item.getAttribute('data-answer') || '';
      const matches = term === '' || question.includes(term) || answer.includes(term);
      
      if (matches) {
        item.style.display = '';
        hasResults = true;
      } else {
        item.style.display = 'none';
      }
    });

    // Show/hide categories based on whether they have visible items
    faqCategories.forEach((category) => {
      const items = category.querySelectorAll('.faq-item');
      let categoryHasVisibleItems = false;
      
      items.forEach((item) => {
        if (item.style.display !== 'none') {
          categoryHasVisibleItems = true;
        }
      });
      
      if (categoryHasVisibleItems) {
        category.style.display = '';
      } else {
        category.style.display = 'none';
      }
    });

    // Show/hide no results message
    if (hasResults || term === '') {
      noResults?.classList.add('hidden');
    } else {
      noResults?.classList.remove('hidden');
    }
  }

  searchInput?.addEventListener('input', (e) => {
    filterFAQs(e.target.value);
  });

  // Handle URL hash for direct linking to specific FAQs
  if (window.location.hash) {
    const hash = decodeURIComponent(window.location.hash.substring(1));
    searchInput.value = hash;
    filterFAQs(hash);
    searchInput.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }
</script>
